name: Daily Birthday Check

on:
  schedule:
    - cron: '0 0 * * *'  # æ¯å¤© UTC 00:00ï¼ˆåŒ—äº¬æ—¶é—´æ—©ä¸Š8ç‚¹ï¼‰
  workflow_dispatch:

env:
  TZ: Asia/Shanghai  # è®¾ç½®ä¸ºåŒ—äº¬æ—¶é—´
  REGISTRY: ghcr.io

jobs:
  check-birthdays-pro:
    name: ðŸ” ProçŽ¯å¢ƒ - æ£€æŸ¥ç”Ÿæ—¥
    environment: Pro
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ åˆ›å»ºé…ç½®æ–‡ä»¶
        run: |
          mkdir -p config
          cat > config/config.yml << 'EOF'
          ${{ vars.BIRTHDAY_YAML }}
          EOF

      - name: ðŸ³ æ‹‰å–å¹¶è¿è¡Œ Docker é•œåƒ
        run: |
          docker run --rm \
            -v $PWD/config/config.yml:/app/config.yml \
            -e TZ=Asia/Shanghai \
            ${{ env.REGISTRY }}/${{ github.repository }}:latest \
            run --config /app/config.yml
