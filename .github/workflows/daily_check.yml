name: Daily Birthday Check

# ğŸŒŸ è§¦å‘å™¨ï¼šæ¯å¤©è¿è¡Œä¸€æ¬¡ + å…è®¸æ‰‹åŠ¨è§¦å‘
on:
  schedule:
    - cron: '0 0 * * *'  # æ¯å¤© UTC 00:00 è¿è¡Œï¼ˆåŒ—äº¬æ—¶é—´æ—©ä¸Š8ç‚¹ï¼‰
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘å…¥å£ï¼ˆåœ¨GitHub UIä¸­ç‚¹æŒ‰é’®ï¼‰
jobs:
  check-birthdays:
    name: æ£€æŸ¥ä»Šæ—¥ç”Ÿæ—¥å¹¶å‘é€æé†’
    environment: Test
    runs-on: ubuntu-latest
    # ğŸ“¦ ç¯å¢ƒå˜é‡ï¼ˆå…¨å±€ï¼‰
    env:
      TZ: Asia/Shanghai  # è®¾ç½®ä¸ºåŒ—äº¬æ—¶é—´ï¼ˆé¿å…æ—¶é—´åå·®ï¼‰
    steps:
    # 1ï¸âƒ£ æ‹‰å–ä»“åº“ä»£ç 
    - name: ğŸ›ï¸ Checkout code
      uses: actions/checkout@v3

    # 2ï¸âƒ£ è®¾ç½® Python è¿è¡Œç¯å¢ƒ
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    # 3ï¸âƒ£ å®‰è£…ä¾èµ–åŒ…
    - name: ğŸ“¦ Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 4ï¸âƒ£ åˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆé€šè¿‡ GitHub Secret æ³¨å…¥ YAML å†…å®¹ï¼‰
    - name: ğŸ› ï¸ Create config file from secret
      run: |
        echo "${{ vars.BIRTHDAY_YAML }}" > config.yml

    # 5ï¸âƒ£ è®°å½•å½“å‰è¿è¡Œæ—¶é—´ï¼ˆç”¨äºè°ƒè¯•ï¼‰
    - name: ğŸ•“ Show current time
      run: date

    # 6ï¸âƒ£ æ‰§è¡Œç”Ÿæ—¥æ£€æŸ¥é€»è¾‘ï¼Œè¾“å‡ºæ˜¯å¦æœ‰ç”Ÿæ—¥
    - name: ğŸ‰ Run birthday check
      id: check
      run: |
        echo "ğŸ“¢ Running birthday check..."
        python -m src.main run 
 